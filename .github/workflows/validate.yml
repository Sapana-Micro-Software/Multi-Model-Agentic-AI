name: Validate Website

on:
  pull_request:
    paths:
      - 'docs/**'
      - '.github/workflows/pages.yml'
  push:
    branches:
      - main
    paths:
      - 'docs/**'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check HTML file exists
        run: |
          if [ ! -f docs/index.html ]; then
            echo "❌ Error: docs/index.html not found"
            exit 1
          fi
          echo "✅ docs/index.html exists"

      - name: Validate HTML structure
        run: |
          if ! grep -q "<!DOCTYPE html>" docs/index.html; then
            echo "❌ Error: Missing DOCTYPE declaration"
            exit 1
          fi
          if ! grep -q "<html" docs/index.html; then
            echo "❌ Error: Missing <html> tag"
            exit 1
          fi
          if ! grep -q "</html>" docs/index.html; then
            echo "❌ Error: Missing </html> closing tag"
            exit 1
          fi
          echo "✅ HTML structure is valid"

      - name: Check file size
        run: |
          SIZE=$(wc -c < docs/index.html)
          if [ $SIZE -lt 1000 ]; then
            echo "⚠️  Warning: HTML file seems too small ($SIZE bytes)"
          else
            echo "✅ HTML file size: $SIZE bytes"
          fi

      - name: Validate workflow YAML
        run: |
          python3 -c "import yaml; yaml.safe_load(open('.github/workflows/pages.yml'))"
          echo "✅ Workflow YAML is valid"

